{#
 ====================================================================
 CRUSHSim - CRUSH Simulation web app for Ceph admins
 ---------------------------------------------------
 
 By Xavier Villaneau, 2015
 xavier.villaneau@fr.clara.net or xvillaneau@gmail.com
 Claranet SAS, Rennes, France
 ====================================================================
 analyze.html - Jinja template for the Analyze page
  - Top: shows the currently selected CRUSH maps, if any
  - Middle: menu for selecting maps among existing ones
  - Bottom: Forms for selecting pool properties, and submit button

 Changelog:
 ----------
 May 4th 2015 - Initial release
 June 15th 2015 - The maps list is now handled by maps-list.js
#}
{% extends "layout.html" %}
{% block main %}
	<h1>CRUSH map selection</h1>
	<div class="row">
		<div class="col-sm-6" id="crush-ini">
			<h2>Initial CRUSH map</h2>
			<h4 class="crush-id"></h4>
			<pre class="panel panel-default pre-scrollable" style="display: none;"></pre>
		</div>
		<div class="col-sm-6" id="crush-fin">
			<h2>Final CRUSH map</h2>
			<h4 class="crush-id"></h4>
			<pre class="panel panel-default pre-scrollable" style="display: none;"></pre>
		</div>
	</div>
	<div class="row">
		<div class="col-md-6">
			<h2>Saved CRUSH maps</h2>
			<div class="crush-maps-list">
				<table class="table table-striped table-hover">
					<thead>
						<tr>
							<th>ID</th>
							<th>Last modified</th>
							<th></th>
							<th></th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>
			</div>
		</div>
		<div class="col-md-6">
			<h2>CRUSH map preview</h2>
			<p>Click on a CRUSH map in the list to see its contents</p>
			<pre class="panel panel-default pre-scrollable" id="crush-map-preview">
			</pre>
		</div>
	</div>
	<h1>Pool and context selection</h1>
	<p>Choose a rule and a wanted number of replicas (in other words, pool settings)</p>
	<div class="row">
		<div class="col-sm-6">
			<h2>Initial pool settings</h2>
			<form id="pool-ini" action="javascript:void(0);" >
				<div class="form-group">
					<label for="pool-ini-rule">CRUSH rule</label>
					<select class="form-control" id="pool-ini-rule" name="ini-rule"></select>
				</div>
				<div class="form-group">
					<label for="pool-ini-size">Number of OSDs to select</label>
					<input type="text" class="form-control" id="pool-ini-size" name="ini-size">
				</div>
				<div class="form-group">
					<label for="pool-ini-minsize">Minimal size of the selection</label>
					<input type="text" class="form-control" id="pool-ini-minsize" name="ini-minsize">
				</div>
			</form>
		</div>
		<div class="col-sm-6">
			<h2>Final pool settings</h2>
			<form id="pool-fin" action="javascript:void(0);" >
				<div class="form-group">
					<label for="pool-fin-rule">CRUSH rule</label>
					<select class="form-control" id="pool-fin-rule" name="fin-rule"></select>
				</div>
				<div class="form-group">
					<label for="pool-fin-size">Number of OSDs to select</label>
					<input type="text" class="form-control" id="pool-fin-size" name="fin-size">
				</div>
				<div class="form-group">
					<label for="pool-fin-minsize">Minimal size of the selection</label>
					<input type="text" class="form-control" id="pool-fin-minsize" name="fin-minsize">
				</div>
			</form>
		</div>
	</div>
	<form id="launch-simulation" action="javascript:void(0);" style="margin-top: 50px;" >
		<button type=submit" class="btn btn-lg btn-primary disabled">
			Launch simulation
		</button>									
	</form>
{% endblock %}
{% block footer %}
	<script>
		// Function used by maps-list.js to make the buttons. Is actually defined in analyze.js
		// but we have to define it globally because maps-list.js is loaded first.
		var mapRowButton;
	</script>
	<script src="{{ url_for('static', filename='maps-list.js') }}"></script>	
	<script src="{{ url_for('static', filename='lib/js.cookie.js') }}"></script>	
	<script src="{{ url_for('static', filename='analyze.js') }}"></script>	
{% endblock %}
{# vim: set syntax=htmljinja ts=4 sw=4 autoindent:#}
